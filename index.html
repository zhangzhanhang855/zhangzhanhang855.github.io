<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ZZH Music Player - éŸ³ä¹æ’­æ”¾å™¨</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #0a0a0a;
      color: #fff;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 20px;
      /* ç§»é™¤ overflow: hidden; å…è®¸é¡µé¢æ»šåŠ¨ */
      overflow-y: auto;
      overflow-x: hidden;
    }

    /* åŠ¨æ€èƒŒæ™¯ */
    .bg-blur {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      filter: blur(40px) brightness(0.3);
      opacity: 0;
      transition: opacity 0.8s ease;
      z-index: 0;
    }

    .bg-blur.active {
      opacity: 1;
    }

    /* å®¹å™¨ */
    .container {
      display: flex;
      gap: 20px;
      max-width: 1000px;
      width: 100%;
      position: relative;
      z-index: 1;
      flex-wrap: wrap;
      justify-content: center;
      padding: 20px 0;
      min-height: auto;
    }

    /* æ’­æ”¾å™¨ä¸»ä½“ */
    .player {
      width: 100%;
      max-width: 360px;
      background: rgba(30, 30, 30, 0.95);
      backdrop-filter: blur(10px);
      padding: 30px 25px;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 229, 255, 0.2);
      border: 1px solid rgba(0, 229, 255, 0.1);
      text-align: center;
      animation: slideIn 0.6s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* å°é¢ */
    .cover {
      width: 100%;
      height: 220px;
      background: linear-gradient(135deg, #1e1e1e 0%, #2d2d2d 100%);
      margin-bottom: 20px;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0, 229, 255, 0.15);
      border: 2px solid rgba(0, 229, 255, 0.1);
      animation: coverRotate 0.6s ease;
    }

    @keyframes coverRotate {
      from {
        transform: scale(0.8) rotateY(10deg);
      }
      to {
        transform: scale(1) rotateY(0);
      }
    }

    /* æ ‡é¢˜å’Œä¿¡æ¯ */
    .song-info {
      margin-bottom: 20px;
    }

    .title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #00e5ff;
      text-shadow: 0 2px 10px rgba(0, 229, 255, 0.3);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .time-info {
      font-size: 12px;
      color: #888;
      display: flex;
      justify-content: space-between;
      margin-top: 8px;
    }

    /* è¿›åº¦æ¡ */
    .progress-container {
      width: 100%;
      height: 8px;
      background: rgba(68, 68, 68, 0.6);
      border-radius: 4px;
      cursor: pointer;
      margin: 20px 0;
      overflow: hidden;
      transition: height 0.2s;
    }

    .progress-container:hover {
      height: 10px;
    }

    .progress {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #00e5ff 0%, #00d4ff 100%);
      border-radius: 4px;
      box-shadow: 0 0 10px rgba(0, 229, 255, 0.6);
      transition: width 0.1s linear;
    }

    /* æ§åˆ¶æŒ‰é’® */
    .controls {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .controls button {
      background: linear-gradient(135deg, #00e5ff 0%, #00d4ff 100%);
      border: none;
      color: #000;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.3s;
      box-shadow: 0 4px 12px rgba(0, 229, 255, 0.3);
      min-width: 70px;
    }

    .controls button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 229, 255, 0.5);
    }

    .controls button:active {
      transform: translateY(0);
    }

    #playBtn {
      min-width: 90px;
      font-size: 16px;
    }

    /* æ­Œæ›²åˆ—è¡¨ */
    .playlist {
      width: 100%;
      max-width: 600px;
      background: rgba(30, 30, 30, 0.95);
      backdrop-filter: blur(10px);
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 229, 255, 0.2);
      border: 1px solid rgba(0, 229, 255, 0.1);
      animation: slideIn 0.6s ease 0.1s both;
      max-height: 500px;
      overflow-y: auto;
    }

    .playlist::-webkit-scrollbar {
      width: 6px;
    }

    .playlist::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
    }

    .playlist::-webkit-scrollbar-thumb {
      background: #00e5ff;
      border-radius: 10px;
    }

    .playlist::-webkit-scrollbar-thumb:hover {
      background: #00d4ff;
    }

    .playlist-title {
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 15px;
      color: #00e5ff;
      text-shadow: 0 2px 10px rgba(0, 229, 255, 0.3);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .playlist-title::before {
      content: "â™«";
      font-size: 20px;
    }

    .song-item {
      padding: 12px 15px;
      margin-bottom: 8px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(0, 229, 255, 0.1);
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .song-item:hover {
      background: rgba(0, 229, 255, 0.1);
      border-color: rgba(0, 229, 255, 0.3);
      transform: translateX(5px);
    }

    .song-item.active {
      background: linear-gradient(135deg, rgba(0, 229, 255, 0.2) 0%, rgba(0, 212, 255, 0.2) 100%);
      border-color: #00e5ff;
      box-shadow: 0 0 15px rgba(0, 229, 255, 0.3);
    }

    .song-number {
      font-size: 12px;
      color: #888;
      min-width: 25px;
      font-weight: 600;
    }

    .song-item.active .song-number {
      color: #00e5ff;
    }

    .song-name {
      flex: 1;
      text-align: left;
      font-size: 14px;
      color: #ddd;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .song-item.active .song-name {
      color: #00e5ff;
      font-weight: 600;
    }

    .play-icon {
      font-size: 12px;
      color: #00e5ff;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .song-item.active .play-icon {
      opacity: 1;
    }

    /* éŸ³é‡æ§åˆ¶ */
    .volume-control {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
      margin-bottom: 15px;
      border: 1px solid rgba(0, 229, 255, 0.1);
    }

    .volume-icon {
      font-size: 18px;
      min-width: 25px;
      text-align: center;
    }

    .volume-slider {
      flex: 1;
      height: 6px;
      -webkit-appearance: none;
      appearance: none;
      background: rgba(68, 68, 68, 0.6);
      border-radius: 3px;
      outline: none;
      cursor: pointer;
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 14px;
      height: 14px;
      background: linear-gradient(135deg, #00e5ff 0%, #00d4ff 100%);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 8px rgba(0, 229, 255, 0.5);
      transition: all 0.2s;
    }

    .volume-slider::-webkit-slider-thumb:hover {
      transform: scale(1.3);
      box-shadow: 0 0 15px rgba(0, 229, 255, 0.8);
    }

    .volume-slider::-moz-range-thumb {
      width: 14px;
      height: 14px;
      background: linear-gradient(135deg, #00e5ff 0%, #00d4ff 100%);
      border-radius: 50%;
      cursor: pointer;
      border: none;
      box-shadow: 0 0 8px rgba(0, 229, 255, 0.5);
      transition: all 0.2s;
    }

    .volume-slider::-moz-range-thumb:hover {
      transform: scale(1.3);
      box-shadow: 0 0 15px rgba(0, 229, 255, 0.8);
    }

    .volume-value {
      min-width: 35px;
      text-align: right;
      font-size: 12px;
      color: #00e5ff;
      font-weight: 600;
    }

    /* ä¸‹è½½æŒ‰é’® */
    .download-controls {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .download-btn {
      background: linear-gradient(135deg, #ff6b9d 0%, #f06595 100%);
      border: none;
      color: #fff;
      padding: 9px 14px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 13px;
      transition: all 0.3s;
      box-shadow: 0 4px 12px rgba(255, 107, 157, 0.3);
      display: flex;
      align-items: center;
      gap: 6px;
      flex: 1;
      min-width: 140px;
      justify-content: center;
    }

    .download-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 107, 157, 0.5);
    }

    .download-btn:active {
      transform: translateY(0);
    }

    .download-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .download-btn.cover {
      background: linear-gradient(135deg, #ffa502 0%, #ff8c42 100%);
      box-shadow: 0 4px 12px rgba(255, 165, 2, 0.3);
    }

    .download-btn.cover:hover {
      box-shadow: 0 6px 20px rgba(255, 165, 2, 0.5);
    }

    /* é¢å¤–åŠŸèƒ½é¢æ¿ */
    .extra-features {
      padding-top: 15px;
      border-top: 1px solid rgba(0, 229, 255, 0.1);
    }

    .feature-section {
      margin-bottom: 15px;
    }

    .feature-label {
      font-size: 12px;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
      display: block;
    }

    /* åŠ è½½çŠ¶æ€æç¤º */
    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(0, 229, 255, 0.95);
      color: #000;
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: 600;
      font-size: 14px;
      animation: slideInUp 0.3s ease;
      box-shadow: 0 4px 20px rgba(0, 229, 255, 0.4);
      z-index: 1000;
    }

    .toast.success {
      background: rgba(76, 175, 80, 0.95);
    }

    .toast.error {
      background: rgba(244, 67, 54, 0.95);
    }

    @keyframes slideInUp {
      from {
        transform: translateY(100px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    @keyframes slideOutDown {
      from {
        transform: translateY(0);
        opacity: 1;
      }
      to {
        transform: translateY(100px);
        opacity: 0;
      }
    }

    .toast.hide {
      animation: slideOutDown 0.3s ease forwards;
    }

    /* æ­Œè¯æ˜¾ç¤ºé¢æ¿ */
    .lyrics-panel {
      width: 100%;
      max-width: 600px;
      background: rgba(30, 30, 30, 0.95);
      backdrop-filter: blur(10px);
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 229, 255, 0.2);
      border: 1px solid rgba(0, 229, 255, 0.1);
      animation: slideIn 0.6s ease 0.2s both;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .lyrics-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .lyrics-title {
      font-size: 16px;
      font-weight: 700;
      color: #00e5ff;
      text-shadow: 0 2px 10px rgba(0, 229, 255, 0.3);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .lyrics-title::before {
      content: "â™ª";
      font-size: 20px;
    }

    .lyrics-toggle {
      background: rgba(0, 229, 255, 0.1);
      border: 1px solid rgba(0, 229, 255, 0.3);
      color: #00e5ff;
      padding: 4px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 600;
      transition: all 0.3s;
    }

    .lyrics-toggle:hover {
      background: rgba(0, 229, 255, 0.2);
      border-color: #00e5ff;
    }

    .lyrics-toggle.active {
      background: linear-gradient(135deg, #00e5ff 0%, #00d4ff 100%);
      color: #000;
      border-color: #00e5ff;
    }

    /* æ­Œè¯å®¹å™¨ */
    .lyrics-container {
      height: 400px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 12px;
      overflow-y: auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      scroll-behavior: smooth;
      border: 1px solid rgba(0, 229, 255, 0.1);
    }

    .lyrics-container::-webkit-scrollbar {
      width: 6px;
    }

    .lyrics-container::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
    }

    .lyrics-container::-webkit-scrollbar-thumb {
      background: #00e5ff;
      border-radius: 10px;
    }

    .lyrics-container::-webkit-scrollbar-thumb:hover {
      background: #00d4ff;
    }

    /* æ­Œè¯è¡Œ */
    .lyric-line {
      padding: 10px 15px;
      border-radius: 8px;
      transition: all 0.3s ease;
      color: #999;
      font-size: 14px;
      line-height: 1.6;
      text-align: center;
      cursor: pointer;
      border-left: 3px solid transparent;
    }

    .lyric-line:hover {
      background: rgba(0, 229, 255, 0.1);
      border-left-color: #00e5ff;
      color: #ccc;
    }

    /* å½“å‰æ­Œè¯è¡Œ */
    .lyric-line.active {
      color: #00e5ff;
      background: rgba(0, 229, 255, 0.15);
      border-left-color: #00e5ff;
      font-weight: 600;
      font-size: 15px;
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(0, 229, 255, 0.3);
    }

    /* æ— æ­Œè¯æç¤º */
    .no-lyrics {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      color: #666;
      font-size: 14px;
      text-align: center;
    }

    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
      body {
        align-items: flex-start;
        padding: 10px;
      }

      .container {
        flex-direction: column;
        gap: 15px;
      }

      .player {
        max-width: 100%;
      }

      .playlist {
        max-width: 100%;
      }

      .lyrics-panel {
        max-width: 100%;
      }

      .lyrics-container {
        height: 300px;
      }

      .download-controls {
        flex-direction: column;
      }

      .download-btn {
        min-width: 100%;
      }

      .toast {
        left: 10px;
        right: 10px;
        bottom: 10px;
      }
    }

    /* éŸ³é¢‘å…ƒç´ éšè— */
    audio {
      display: none;
    }

    /* åŠ è½½åŠ¨ç”» */
    .loading {
      display: inline-block;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(360deg);
      }
    }

    /* éŸ³é‡å¯è§†åŒ–æŒ‡ç¤º */
    .playing-indicator {
      display: inline-block;
      width: 4px;
      height: 4px;
      background: #00e5ff;
      border-radius: 50%;
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 1;
        transform: scale(1);
      }
      50% {
        opacity: 0.5;
        transform: scale(1.5);
      }
    }
  </style>
</head>
<body>

<!-- åŠ¨æ€èƒŒæ™¯ -->
<div class="bg-blur" id="bgBlur"></div>

<!-- ä¸»å®¹å™¨ -->
<div class="container">
  <!-- æ’­æ”¾å™¨ -->
  <div class="player">
    <img src="" id="cover" class="cover" alt="æ­Œæ›²å°é¢" />
    
    <div class="song-info">
      <div class="title" id="songTitle">åŠ è½½ä¸­...</div>
      <div class="time-info">
        <span id="currentTime">00:00</span>
        <span id="duration">00:00</span>
      </div>
    </div>

    <div class="progress-container" id="progressContainer">
      <div class="progress" id="progress"></div>
    </div>

    <div class="controls">
      <button onclick="prevSong()">â®ï¸ ä¸Šä¸€é¦–</button>
      <button onclick="togglePlay()" id="playBtn">â–¶ï¸ æ’­æ”¾</button>
      <button onclick="nextSong()">ä¸‹ä¸€é¦– â­ï¸</button>
    </div>

    <div class="controls">
      <button onclick="toggleLoop()" id="loopBtn">ğŸ” å•æ›²å¾ªç¯</button>
    </div>

    <!-- é¢å¤–åŠŸèƒ½ -->
    <div class="extra-features">
      <!-- éŸ³é‡æ§åˆ¶ -->
      <div class="feature-section">
        <span class="feature-label">éŸ³é‡</span>
        <div class="volume-control">
          <span class="volume-icon">ğŸ”Š</span>
          <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="70">
          <span class="volume-value" id="volumeValue">70%</span>
        </div>
      </div>

      <!-- ä¸‹è½½åŠŸèƒ½ -->
      <div class="feature-section">
        <span class="feature-label">ä¸‹è½½</span>
        <div class="download-controls">
          <button class="download-btn" onclick="downloadAudio()">
            <span>â¬‡ï¸</span>
            <span>éŸ³é¢‘</span>
          </button>
          <button class="download-btn cover" onclick="downloadCover()">
            <span>â¬‡ï¸</span>
            <span>å°é¢</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- æ­Œæ›²åˆ—è¡¨ -->
  <div class="playlist">
    <div class="playlist-title">æ’­æ”¾åˆ—è¡¨</div>
    <div id="playlistContainer"></div>
  </div>

  <!-- æ­Œè¯é¢æ¿ -->
  <div class="lyrics-panel">
    <div class="lyrics-header">
      <div class="lyrics-title">æ­Œè¯</div>
      <button class="lyrics-toggle active" id="lyricsToggle" onclick="toggleLyricsDisplay()">éšè—</button>
    </div>
    <div class="lyrics-container" id="lyricsContainer">
      <div class="no-lyrics">æš‚æ— æ­Œè¯</div>
    </div>
  </div>

<audio id="audio"></audio>

<script>
  const songs = [
    {
      name: "Faded - Alan Walker",
      url: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/Faded - Alan Walker.mp3",
      cover: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/Faded - Alan Walker.jpeg",
      lyrics: `[00:00.85]Faded (æ†”æ‚´ä¸å ª) - Alan Walker (è‰¾ä¼¦Â·æ²ƒå…‹)
[00:01.44]
[00:01.44]Written byï¼šAlan Walker
[00:11.32]
[00:11.32]You were the shadow to my light
[00:14.05]Did you feel us
[00:18.04]Another start
[00:19.85]You fade away
[00:21.75]Afraid our aim is out of sight
[00:24.86]Wanna see us
[00:28.68]Alight
[00:31.15]Where are you now
[00:36.46]Where are you now
[00:41.65]Where are you now
[00:44.51]Was it all in my fantasy
[00:47.28]Where are you now
[00:49.77]Were you only imaginary
[00:53.95]Where are you now
[00:57.38]Atlantis
[00:59.06]Under the sea
[01:01.66]Under the sea
[01:04.5]Where are you now
[01:07.06]Another dream
[01:10.62]The monsters running wild inside of me
[01:14.39]I'm faded
[01:19.92]I'm faded
[01:23.74]So lost
[01:25.41]I'm faded
[01:30.62]I'm faded
[01:34.55]So lost
[01:35.880005]I'm faded
[01:37.81]These shallow waters never met
[01:40.69]What I needed
[01:44.61]I'm letting go
[01:46.42]A deeper dive
[01:48.42]Eternal silence of the sea
[01:51.729996]I'm breathing
[01:55.270004]Alive
[01:57.96]Where are you now
[02:03.21]Where are you now
[02:08.51]Under the bright
[02:09.91]But faded lights
[02:11.1]You set my heart on fire
[02:13.82]Where are you now
[02:16.45999]Where are you now
[02:31.31]Where are you now
[02:34.66]Atlantis
[02:36.69]Under the sea
[02:39.12]Under the sea
[02:41.94]Where are you now
[02:44.33]Another dream
[02:47.8]The monsters running wild inside of me
[02:51.79001]I'm faded
[02:57.24]I'm faded
[03:01.12]So lost
[03:02.68]I'm faded
[03:08.03]I'm faded
[03:11.82]So lost
[03:13.12]I'm faded`
    },
    {
      name: "Heading Home - Alan Walker",
      url: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/Heading Home - Alan Walker [Normal Quality].mp3",
      cover: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/Heading Home - Alan Walker:Ruben.jpeg",
      lyrics: `[00:00.0]Heading Home - Alan Walker/Ruben
[00:03.05]
[00:03.05]Lyrics byï¼šJesper Borgen/Magnus Bertelsen/Gunnar Greve/Ã˜yvind Sauvik
[00:06.11]
[00:06.11]Composed byï¼šAlan Walker/Jesper Borgen/Magnus Bertelsen/Marcus Arnbekk/Anders FrÃ¸en/Carl Hovind/Gunnar Greve/Ã˜yvind Sauvik/Fredrik Borch Olsen/Jesper Jenset
[00:09.17]
[00:09.17]I was so insatiable
[00:13.65]'Til the lights came on and the stories got old
[00:18.16]Now there's no one here I know
[00:22.64]And the city outside it's not the same anymore
[00:26.83]And I I remember when we were young
[00:31.27]We'd write our names in the sand
[00:35.26]So carelessly
[00:36.62]Then the rain came and yours was gone
[00:39.91]And now mine it stays alone
[00:45.12]Nobody sees me now I'm a one man show
[00:51.25]I'll do this on my own
[00:54.03]We knew it all then now this is all I know
[01:00.16]Guess I'm heading home now
[01:02.74]Ooh ooh ooh ooh
[01:04.51]
[01:04.51]Yeah
[01:05.41]
[01:05.41]Ooh ooh ooh ooh
[01:07.59]
[01:07.59]Ooh ooh ooh ooh
[01:09.06]
[01:09.06]Guess I'm heading home now
[01:11.85]Ooh ooh ooh ooh
[01:14.24]
[01:14.24]Ooh ooh ooh ooh
[01:17.9]
[01:17.9]Guess I'm heading home now
[01:20.32]When the music always played
[01:24.81]With the sound of our lives and the sweetest escape
[01:29.3]And the neighbors would complain
[01:33.72]We would turn it up louder who cares anyway
[01:37.880005]'Cause we we remember that we were young
[01:42.259995]Our lives were grains in the sand
[01:46.759995]And we made up castles and kingdoms of
[01:51.04]Now the rains have torn them down
[01:56.270004]Nobody sees me now I'm a one man show
[02:01.31]Ooh ooh ooh ooh
[02:02.62]
[02:02.62]Yeah
[02:03.18]
[02:03.18]Ooh ooh ooh ooh
[02:05.35]
[02:05.35]Ooh ooh ooh ooh
[02:06.79]
[02:06.79]Guess I'm heading home now
[02:09.28]Ooh ooh ooh ooh
[02:12.03]
[02:12.03]Ooh ooh ooh ooh
[02:14.23]
[02:14.23]Ooh ooh ooh ooh
[02:15.6]
[02:15.6]Guess I'm heading home now
[02:18.48]You'll find me
[02:22.93]I'll be here oh
[02:27.18]I can't see
[02:31.75]I can't breathe anymore
[02:35.86]But how could we have stayed
[02:40.16]You were high on love I was drunk
[02:43.79001]Drunk on the pain ooh
[02:46.56]Ooh ooh ooh ooh
[02:49.14]
[02:49.14]Yes I'm heading I'm heading I'm heading
[02:51.20999]Ooh ooh ooh ooh
[02:53.04001]
[02:53.04001]I'm heading home now hmm
[02:55.54001]Ooh ooh ooh ooh
[02:56.24]
[02:56.24]Ooh ooh ooh ooh
[02:58.38]
[02:58.38]Ooh ooh ooh ooh
[03:00.19]
[03:00.19]Guess I'm heading home now`
    },
    {
      name: "Sunburst - Tobu",
      url: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/Sunburst - Tobu.mp3",
      cover: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/SunburstÃ¯Â¼Ë†Ã¤Âº'Ã©Å¡â„¢Ã©ËœÂ³Ã¥â€¦â€°Ã¯Â¼â€° - Tobu:Itro.jpeg",
      lyrics: `[00:00.00]No Content`
    },
    {
      name: "World of Walker: Rise of the drones - Alan Walker",
      url: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/Rise of the drones.mp3",
      cover: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/World of Walker: Rise of the Drones - Alan Walker.jpeg",
      lyrics: `[00:00.0]World of Walker: Rise of the Drones - Alan Walker (è‰¾å…°Â·æ²ƒå…‹)
[01:02.97]Lyrics byï¼šGunnar Greve/Fredrik Borch Olsen/Mats Lie SkÃ¥re/Marcus Arnbekk/Phoebe Ryan
[02:05.95]
[02:05.95]Composed byï¼šAlan Walker/Gunnar Greve/Fredrik Borch Olsen/Mats Lie SkÃ¥re/Marcus Arnbekk/Phoebe Ryan/James Njie
[03:08.93]
[03:08.93]I had a nightmare I can't sleep alone
[03:12.8]I'm scared to wake up in a world I don't know
[03:18.25]I try to run though I just can't escape
[03:23.22]But if you're here then you can scare these nightmares away`
    },
    {
      name: "The Sky High - Elektronomia",
      url: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/The Sky High - Elektronomia.mp3",
      cover: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/The Sky High - Elektronomia.jpeg",
      lyrics: `[00:04.34]I'm laying where the stars shine so bright
[00:08.3]Dreams of younger days keep drifting by
[00:11.87]Oh, how I wish to turn the hands of time, tonight
[00:19.29]Through moonlit mist, a meadow calls my name
[00:23.3]Leading me through whispers laced with flame
[00:27.05]Faces from my past now circle around
[00:31.23]And now we are dancing wild and free In love and harmony, for infinity
[00:39.72]We soar high, breaking through the sky
[00:43.78]And side by side, forever we fly, The Sky High
[01:11.86]The starry sky ignites the night Hearts now as one, it feels so right
[01:19.36]A final toast to days gone by (the days gone by)
[01:26.79]No matter where the wind may take us now
[01:30.74]We'll find our way back home safe and sound
[01:34.6]Guided by the stars, we'll chase the light,tonight
[01:42.03]You and I escape reality
[01:45.8]Can't you see it's our destiny And now we are dancing wild
[01:53.79]and free in love and harmony, for infinity
[01:58.490005]We soar high, breaking through the sky
[02:02.51]And side by side,forever we fly, The Sky High`
    },
    {
      name: "365",
      url: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/365.mp3",
      cover: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/365 - Zedd:Katy Perry.jpeg",
      lyrics: `[00:00.0]365 - Zedd/Katy Perry
[00:01.48]
[00:01.48]Lyrics byï¼šAnton Zaslavski/Katy Perry/Caroline Ailin/Corey Sanders/Daniel Davidsen/Peter Wallevik/Mich Hansen
[00:02.96]
[00:02.96]Composed byï¼šAnton Zaslavski/Katy Perry/Caroline Ailin/Corey Sanders/Daniel Davidsen/Peter Wallevik/Mich Hansen
[00:04.45]
[00:04.45]Waking up next to you in the middle of the week
[00:09.23]Never needed anyone to send me off to sleep
[00:13.26]And I know I said go slow
[00:15.68]But I can't hold back no more
[00:19.04]Got a premonition this ain't going to be a fling
[00:23.84]You make a weekend feel like a year
[00:26.48]Baby you got me changing
[00:28.89]24/7 I want you here
[00:31.33]I hope you feel the same thing
[00:33.71]I want you to be the one
[00:34.88]That's on my mind on my mind on my mind
[00:38.65]I want you to be there on a Monday night
[00:41.1]Tuesday night every night
[00:43.56]Are you going to be the one
[00:44.58]That's on my mind 365 all the time
[00:48.47]I want you to be the one to stay
[00:51.18]Nd give me the night and day
[00:55.75]Love it when you come back and can't take it when you leave
[01:00.71]Got me fantasizing our initials already
[01:04.76]And I want to just let go falling deeper than before
[01:10.43]Say that you already lock it up in a heartbeat
[01:15.25]I want you to be the one
[01:16.41]That's on my mind on my mind on my mind
[01:20.29]I want you to be there on a Monday night
[01:22.729996]Tuesday Night every night
[01:25.1]Are you going to be the one that's on my mind 365 all the time
[01:30.09]I want you to be the one to stay
[01:32.81]And give me the night and day
[01:35.09]I think about you all the time
[01:39.91]24/7 365
[01:44.770004]
[01:44.770004]I think about you all the time
[01:49.65]24/7 365
[02:11.59]
[02:11.59]I want you to be the one
[02:14.14]I want you to be the one
[02:15.16]That's on my mind on my mind on my mind
[02:19.07]I want you to be there on a Monday night
[02:21.61]Tuesday Night every night
[02:23.86]Are you going to be the one
[02:25.0]That's on my mind 365 all the time
[02:28.85]I want you to be the one to stay
[02:31.59]And give me the night and day
[02:33.74]I think about you all the time
[02:38.68]24/7 365
[02:43.51]
[02:43.51]I think about you all the time
[02:48.44]24/7 365
[02:53.044]`
    },
    {
      name: "BARRETE!",
      url: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/DERRETE!.mp3",
      cover: "https://raw.githubusercontent.com/zhangzhanhang855/zhangzhanhang855.github.io/main/BARRETE! - CHASHKAKEFIRA:D4C.jpeg",
      lyrics: `[00:00:00]No Content`
    }
  ];

  let index = 0;
  let isPlaying = false;

  const audio = document.getElementById("audio");
  const title = document.getElementById("songTitle");
  const cover = document.getElementById("cover");
  const progress = document.getElementById("progress");
  const playBtn = document.getElementById("playBtn");
  const loopBtn = document.getElementById("loopBtn");
  const progressContainer = document.getElementById("progressContainer");
  const bgBlur = document.getElementById("bgBlur");
  const currentTimeEl = document.getElementById("currentTime");
  const durationEl = document.getElementById("duration");
  const playlistContainer = document.getElementById("playlistContainer");
  const volumeSlider = document.getElementById("volumeSlider");
  const volumeValue = document.getElementById("volumeValue");
  const lyricsContainer = document.getElementById("lyricsContainer");
  const lyricsToggle = document.getElementById("lyricsToggle");
  const lyricsPanel = document.querySelector(".lyrics-panel");

  // æ ¼å¼åŒ–æ—¶é—´
  function formatTime(time) {
    if (!time || isNaN(time)) return "00:00";
    const minutes = Math.floor(time / 60);
    const seconds = Math.floor(time % 60);
    return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
  }

  // æ˜¾ç¤ºæç¤ºä¿¡æ¯
  function showToast(message, type = 'success') {
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.textContent = message;
    document.body.appendChild(toast);

    setTimeout(() => {
      toast.classList.add('hide');
      setTimeout(() => toast.remove(), 300);
    }, 2500);
  }

  // =============== æ­Œè¯ç›¸å…³ ===============
  let currentLyricsIndex = 0;
  let parsedLyrics = [];

  // è§£æLRCæ­Œè¯æ ¼å¼
  function parseLyrics(lyricsText) {
    const lines = lyricsText.split('\n');
    const parsed = [];
    
    lines.forEach(line => {
      const match = line.match(/\[(\d{2}):(\d{2})\.(\d{2})\](.*)/);
      if (match) {
        const minutes = parseInt(match[1]);
        const seconds = parseInt(match[2]);
        const time = minutes * 60 + seconds;
        const text = match[4].trim();
        parsed.push({ time, text });
      }
    });
    
    return parsed.sort((a, b) => a.time - b.time);
  }

  // æ¸²æŸ“æ­Œè¯
  function renderLyrics() {
    if (!parsedLyrics || parsedLyrics.length === 0) {
      lyricsContainer.innerHTML = '<div class="no-lyrics">æš‚æ— æ­Œè¯</div>';
      return;
    }

    lyricsContainer.innerHTML = parsedLyrics.map((lyric, idx) => 
      `<div class="lyric-line" data-index="${idx}" onclick="jumpToLyricTime(${lyric.time})">${lyric.text}</div>`
    ).join('');
  }

  // æ›´æ–°å½“å‰æ­Œè¯
  function updateCurrentLyric() {
    if (!parsedLyrics || parsedLyrics.length === 0) return;

    const currentTime = audio.currentTime;
    let newIndex = 0;

    for (let i = 0; i < parsedLyrics.length; i++) {
      if (parsedLyrics[i].time <= currentTime) {
        newIndex = i;
      } else {
        break;
      }
    }

    if (newIndex !== currentLyricsIndex) {
      // ç§»é™¤ä¹‹å‰çš„active
      const prevActive = lyricsContainer.querySelector('.lyric-line.active');
      if (prevActive) prevActive.classList.remove('active');

      // æ·»åŠ æ–°çš„active
      currentLyricsIndex = newIndex;
      const newActive = lyricsContainer.querySelector(`[data-index="${newIndex}"]`);
      if (newActive) {
        newActive.classList.add('active');
        // è‡ªåŠ¨æ»šåŠ¨åˆ°å½“å‰æ­Œè¯
        newActive.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }
  }

  // è·³è½¬åˆ°æ­Œè¯å¯¹åº”çš„æ—¶é—´
  function jumpToLyricTime(time) {
    audio.currentTime = time;
    if (!isPlaying) {
      audio.play();
      isPlaying = true;
      playBtn.textContent = "â¸ï¸ æš‚åœ";
      bgBlur.classList.add("active");
    }
  }

  // åˆ‡æ¢æ­Œè¯æ˜¾ç¤º
  function toggleLyricsDisplay() {
    const isHidden = lyricsPanel.style.display === 'none';
    lyricsPanel.style.display = isHidden ? 'flex' : 'none';
    lyricsToggle.textContent = isHidden ? 'éšè—' : 'æ˜¾ç¤º';
    lyricsToggle.classList.toggle('active');
  }

  // éŸ³é‡æ§åˆ¶
  volumeSlider.addEventListener('input', (e) => {
    const volume = e.target.value;
    audio.volume = volume / 100;
    volumeValue.textContent = `${volume}%`;
  });

  // åˆå§‹åŒ–éŸ³é‡
  audio.volume = 0.7;

  // ä¸‹è½½æ–‡ä»¶çš„é€šç”¨å‡½æ•°
  function downloadFile(url, filename) {
    const xhr = new XMLHttpRequest();
    xhr.responseType = 'blob';
    
    xhr.onload = function() {
      const blob = xhr.response;
      const objectUrl = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = objectUrl;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(objectUrl);
      showToast(`å·²ä¸‹è½½: ${filename}`, 'success');
    };

    xhr.onerror = function() {
      showToast('ä¸‹è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥', 'error');
    };

    xhr.onprogress = function(e) {
      if (e.lengthComputable) {
        const percentComplete = (e.loaded / e.total) * 100;
        // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ è¿›åº¦æ¡æ˜¾ç¤º
      }
    };

    try {
      xhr.open('GET', url, true);
      xhr.send();
    } catch (error) {
      showToast('æ— æ³•ä¸‹è½½æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨è·¨åŸŸé—®é¢˜', 'error');
    }
  }

  // ä¸‹è½½éŸ³é¢‘
  function downloadAudio() {
    if (index >= 0 && index < songs.length) {
      const song = songs[index];
      const filename = `${song.name}.mp3`;
      showToast('æ­£åœ¨ä¸‹è½½éŸ³é¢‘...', 'success');
      downloadFile(song.url, filename);
    }
  }

  // ä¸‹è½½å°é¢
  function downloadCover() {
    if (index >= 0 && index < songs.length) {
      const song = songs[index];
      const filename = `${song.name}-cover.jpg`;
      showToast('æ­£åœ¨ä¸‹è½½å°é¢...', 'success');
      downloadFile(song.cover, filename);
    }
  }

  // åŠ è½½æ­Œæ›²
  function loadSong(i) {
    index = i;
    audio.src = songs[i].url;
    title.textContent = songs[i].name;
    cover.src = songs[i].cover;
    bgBlur.style.backgroundImage = `url('${songs[i].cover}')`;
    
    // åŠ è½½æ­Œè¯
    if (songs[i].lyrics) {
      parsedLyrics = parseLyrics(songs[i].lyrics);
      currentLyricsIndex = 0;
      renderLyrics();
    } else {
      lyricsContainer.innerHTML = '<div class="no-lyrics">æš‚æ— æ­Œè¯</div>';
      parsedLyrics = [];
    }
    
    updatePlaylist();
  }

  // åˆ‡æ¢æ’­æ”¾/æš‚åœ
  function togglePlay() {
    if (isPlaying) {
      audio.pause();
      playBtn.textContent = "â–¶ï¸ æ’­æ”¾";
      bgBlur.classList.remove("active");
    } else {
      audio.play();
      playBtn.textContent = "â¸ï¸ æš‚åœ";
      bgBlur.classList.add("active");
    }
    isPlaying = !isPlaying;
  }

  // ä¸‹ä¸€é¦–
  function nextSong() {
    index = (index + 1) % songs.length;
    loadSong(index);
    audio.play();
    isPlaying = true;
    playBtn.textContent = "â¸ï¸ æš‚åœ";
    bgBlur.classList.add("active");
  }

  // ä¸Šä¸€é¦–
  function prevSong() {
    index = (index - 1 + songs.length) % songs.length;
    loadSong(index);
    audio.play();
    isPlaying = true;
    playBtn.textContent = "â¸ï¸ æš‚åœ";
    bgBlur.classList.add("active");
  }

  // åˆ‡æ¢å¾ªç¯æ¨¡å¼
  function toggleLoop() {
    audio.loop = !audio.loop;
    loopBtn.textContent = audio.loop ? "ğŸ”„ å¾ªç¯ä¸­" : "ğŸ” å•æ›²å¾ªç¯";
  }

  // æ›´æ–°è¿›åº¦æ¡
  audio.addEventListener("timeupdate", () => {
    const percent = (audio.currentTime / audio.duration) * 100;
    progress.style.width = percent + "%";
    currentTimeEl.textContent = formatTime(audio.currentTime);
    
    // æ›´æ–°æ­Œè¯æ˜¾ç¤º
    updateCurrentLyric();
  });

  // åŠ è½½å…ƒæ•°æ®
  audio.addEventListener("loadedmetadata", () => {
    durationEl.textContent = formatTime(audio.duration);
  });

  // ç‚¹å‡»è¿›åº¦æ¡è·³è½¬
  progressContainer.addEventListener("click", e => {
    const width = progressContainer.clientWidth;
    const clickX = e.offsetX;
    const duration = audio.duration;
    audio.currentTime = (clickX / width) * duration;
  });

  // æ­Œæ›²ç»“æŸè‡ªåŠ¨ä¸‹ä¸€é¦–
  audio.addEventListener("ended", () => {
    if (!audio.loop) nextSong();
  });

  // æ¸²æŸ“æ’­æ”¾åˆ—è¡¨
  function updatePlaylist() {
    playlistContainer.innerHTML = songs.map((song, i) => `
      <div class="song-item ${i === index ? 'active' : ''}" onclick="loadSongAndPlay(${i})">
        <span class="song-number">${i + 1}</span>
        <span class="song-name" title="${song.name}">${song.name}</span>
        <span class="play-icon">â™«</span>
      </div>
    `).join('');
  }

  // é€‰æ‹©æ­Œæ›²å¹¶æ’­æ”¾
  function loadSongAndPlay(i) {
    loadSong(i);
    audio.play();
    isPlaying = true;
    playBtn.textContent = "â¸ï¸ æš‚åœ";
    bgBlur.classList.add("active");
  }

  // åˆå§‹åŒ–
  loadSong(index);
  updatePlaylist();
</script>

</body>
</html>
